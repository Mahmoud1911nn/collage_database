# -*- coding: utf-8 -*-
"""collage_Database.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1kQlB-0W-UTqPwQn9Wvo8BTu6UwaYcL5W
"""
import streamlit as st

import sqlite3
import pandas as pd

# Ø¥Ù†Ø´Ø§Ø¡ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø¯Ø§Ø®Ù„ Ø§Ù„Ø°Ø§ÙƒØ±Ø©
conn = sqlite3.connect(":memory:")
cursor = conn.cursor()

# Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø·Ù„Ø§Ø¨
cursor.execute("""
CREATE TABLE Students (
    StudentID INTEGER PRIMARY KEY AUTOINCREMENT,
    FullName TEXT NOT NULL,
    Department TEXT,
    Email TEXT,
    EnrollmentYear INTEGER
);
""")

# Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù‚Ø±Ø±Ø§Øª
cursor.execute("""
CREATE TABLE Courses (
    CourseID INTEGER PRIMARY KEY AUTOINCREMENT,
    CourseName TEXT NOT NULL,
    Credits INTEGER,
    Department TEXT
);
""")

# Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ø³Ø§ØªØ°Ø©
cursor.execute("""
CREATE TABLE Professors (
    ProfessorID INTEGER PRIMARY KEY AUTOINCREMENT,
    FullName TEXT NOT NULL,
    Department TEXT,
    Email TEXT
);
""")

# Ø¬Ø¯ÙˆÙ„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø±Ø±Ø§Øª
cursor.execute("""
CREATE TABLE Enrollments (
    EnrollmentID INTEGER PRIMARY KEY AUTOINCREMENT,
    StudentID INTEGER,
    CourseID INTEGER,
    Grade TEXT,
    FOREIGN KEY (StudentID) REFERENCES Students(StudentID),
    FOREIGN KEY (CourseID) REFERENCES Courses(CourseID)
);
""")

# Ø¥Ø¯Ø®Ø§Ù„ Ø·Ù„Ø§Ø¨
cursor.executemany("""
INSERT INTO Students (FullName, Department, Email, EnrollmentYear)
VALUES (?, ?, ?, ?)
""", [
    ("Ahmed Ali", "Computer Science", "ahmed.cs@example.com", 2022),
    ("Mona Hassan", "Business", "mona.bus@example.com", 2021),
    ("Omar Youssef", "Engineering", "omar.eng@example.com", 2023)
])

# Ø¥Ø¯Ø®Ø§Ù„ Ù…Ù‚Ø±Ø±Ø§Øª
cursor.executemany("""
INSERT INTO Courses (CourseName, Credits, Department)
VALUES (?, ?, ?)
""", [
    ("Database Systems", 3, "Computer Science"),
    ("Marketing 101", 2, "Business"),
    ("Thermodynamics", 4, "Engineering")
])

# Ø¥Ø¯Ø®Ø§Ù„ Ø£Ø³Ø§ØªØ°Ø©
cursor.executemany("""
INSERT INTO Professors (FullName, Department, Email)
VALUES (?, ?, ?)
""", [
    ("Dr. Samir Fahmy", "Computer Science", "samir.cs@example.com"),
    ("Dr. Hala Ibrahim", "Business", "hala.bus@example.com"),
    ("Dr. Mahmoud Tarek", "Engineering", "mahmoud.eng@example.com")
])

# Ø¥Ø¯Ø®Ø§Ù„ ØªØ³Ø¬ÙŠÙ„Ø§Øª Ø·Ù„Ø§Ø¨
cursor.executemany("""
INSERT INTO Enrollments (StudentID, CourseID, Grade)
VALUES (?, ?, ?)
""", [
    (1, 1, "A"),
    (2, 2, "B+"),
    (3, 3, "A-"),
    (1, 2, "B")  # Ø£Ø­Ù…Ø¯ Ø³Ø¬Ù„ Ù…Ø§Ø¯Ø© Ù…Ù† Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„
])

conn.commit()

# Ø¹Ø±Ø¶ ÙƒÙ„ Ø§Ù„Ø·Ù„Ø§Ø¨
df_students = pd.read_sql("SELECT * FROM Students", conn)
st.write("ğŸ“Œ Ø§Ù„Ø·Ù„Ø§Ø¨:")
st.dataframe(df_students)

# Ø¹Ø±Ø¶ ÙƒÙ„ Ø§Ù„Ù…Ù‚Ø±Ø±Ø§Øª
df_courses = pd.read_sql("SELECT * FROM Courses", conn)
st.write("ğŸ“Œ Ø§Ù„Ù…Ù‚Ø±Ø±Ø§Øª:")
st.dataframe(df_courses)

# Ø¹Ø±Ø¶ ÙƒÙ„ Ø§Ù„Ø£Ø³Ø§ØªØ°Ø©
df_professors = pd.read_sql("SELECT * FROM Professors", conn)
st.write("ğŸ“Œ Ø§Ù„Ø£Ø³Ø§ØªØ°Ø©:")
st.dataframe(df_professors)

# Ø¹Ø±Ø¶ ØªØ³Ø¬ÙŠÙ„Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ Ù…Ø¹ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù‚Ø±Ø±Ø§Øª
query = """
SELECT
    E.EnrollmentID, S.FullName AS StudentName, C.CourseName, E.Grade
FROM
    Enrollments E
JOIN Students S ON E.StudentID = S.StudentID
JOIN Courses C ON E.CourseID = C.CourseID;
"""
df_enrollments = pd.read_sql(query, conn)
print("ğŸ“Œ ØªØ³Ø¬ÙŠÙ„Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨:")
display(df_enrollments)

